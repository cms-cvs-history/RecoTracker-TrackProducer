process PROD = {

   # initialize  MessageLogger
   include "RecoTracker/RoadSearchCloudMaker/test/messages.cfg"

	source = PoolSource { 
          untracked vstring fileNames = {'file:CleanToTrackCandidates.root'}
          untracked int32 maxEvents = 10
          untracked uint32 debugVerbosity = 10
          untracked bool   debugFlag     = true
	}

	es_source magfield = XMLIdealGeometryESSource {
		  FileInPath GeometryConfiguration ="Geometry/CMSCommonData/data/FieldConfiguration.xml"
		  #the proper root node is set in the xml file
		  string rootNodeName=""
		}
        es_module = VolumeBasedMagneticFieldESProducer {
 	           double findVolumeTolerance = 0.0
 	           untracked bool cacheLastVolume = true
	           untracked bool timerOn = false
		}


        es_source = XMLIdealGeometryESSource {
	   FileInPath GeometryConfiguration="Geometry/TrackerSimData/data/trackerSimConfiguration.xml"
           string rootNodeName = ""
        }

        es_module = TrackerGeometricDetESModule {}
#	es_module = TrackerRecoGeometryESProducer {}
        es_module = TrackerDigiGeometryESModule {}
	
	#
# define all the needed ES Sources
#

	es_module p1 = AnalyticalPropagatorESProducer{
		string ComponentName = "AnalyticalPropagator" 	
		string PropagationDirection = "alongMomentum"
	}
	es_module p2 = AnalyticalPropagatorESProducer{
		string ComponentName = "AnalyticalPropagatorOpposite" 	
		string PropagationDirection = "oppositeToMomentum"
	}
	es_module = KFUpdatorESProducer{
		string ComponentName = "KFUpdator" 	
	}
	es_module = Chi2MeasurementEstimatorESProducer{
		string ComponentName = "Chi2" 	
		double MaxChi2 = 1. 
		double nSigma = 3.
	}
	es_module = KFTrajectoryFitterESProducer {
		string ComponentName = "KFFitter" 	
		string  Propagator = "AnalyticalPropagator" 
		string Updator = "KFUpdator"
		string Estimator = "Chi2"
	}
	es_module = KFTrajectorySmootherESProducer {
		string ComponentName = "KFSmoother" 	
		string  Propagator = "AnalyticalPropagatorOpposite" 
		string Updator = "KFUpdator"
		string Estimator = "Chi2"

	}
	es_module = KFFittingSmootherESProducer {
		string ComponentName = "KFFittingSmoother" 	
		string  Fitter = "KFFitter" 
		string Smoother = "KFSmoother"

	}
	
	module trackp = TrackProducer {
		string Fitter = "KFFittingSmoother" 	
		string Propagator = "AnalyticalPropagator" 
		string src = "trackcandidates"
	}

      	module out = PoolOutputModule {
               untracked string fileName = 'Tracks.root'
        }
	path p = {trackp}
 	endpath e = {
    		out
	}
}
