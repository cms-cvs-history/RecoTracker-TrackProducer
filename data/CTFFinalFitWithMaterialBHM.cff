#special propagator
include "TrackingTools/GeomPropagators/data/BeamHaloPropagator.cff"

# KFTrajectoryFitterESProducer
#include "TrackingTools/TrackFitters/data/KFTrajectoryFitterESProducer.cfi"
es_module KFTrajectoryFitterBeamHalo = KFTrajectoryFitter from "TrackingTools/TrackFitters/data/KFTrajectoryFitterESProducer.cfi"
replace KFTrajectoryFitterBeamHalo.ComponentName = "KFFitterBH"
replace KFTrajectoryFitterBeamHalo.Propagator = "BeamHaloPropagatorAlong"

# KFTrajectorySmootherESProducer
#include "TrackingTools/TrackFitters/data/KFTrajectorySmootherESProducer.cfi"
es_module KFTrajectorySmootherBeamHalo = KFTrajectorySmoother from "TrackingTools/TrackFitters/data/KFTrajectorySmootherESProducer.cfi"
replace KFTrajectorySmootherBeamHalo.ComponentName = "KFSmootherBH"
replace KFTrajectorySmootherBeamHalo.Propagator = "BeamHaloPropagatorAlong"

# KFFittingSmootherESProducer
#include "TrackingTools/TrackFitters/data/KFFittingSmootherESProducer.cfi"
es_module KFFittingSmootherBeamHalo = KFFittingSmoother from "TrackingTools/TrackFitters/data/KFFittingSmootherESProducer.cfi"
replace KFFittingSmootherBeamHalo.ComponentName = "KFFittingSmootherBH"
replace KFFittingSmootherBeamHalo.Fitter = "KFFitterBH"
replace KFFittingSmootherBeamHalo.Smoother = "KFSmootherBH"


############## generate the final tracks ######################
#get the dependencies
include "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cff"
#clone the track producer
module ctfWithMaterialTracksBeamHaloMuon = ctfWithMaterialTracks from "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
replace ctfWithMaterialTracksBeamHaloMuon.Fitter = "KFFittingSmootherBH"
replace ctfWithMaterialTracksBeamHaloMuon.Propagator = "BeamHaloPropagatorAlong"
replace ctfWithMaterialTracksBeamHaloMuon.src = ckfTrackCandidatesBeamHaloMuon
